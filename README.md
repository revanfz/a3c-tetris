Old version of implementation for debugging and testing